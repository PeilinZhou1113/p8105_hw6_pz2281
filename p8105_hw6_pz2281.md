p8105\_hw6\_pz2281
================
Peilin Zhou

``` r
library(tidyverse)
library(modelr)
library(mgcv)
library(ggplot2)
```

## Problem 1

Import data for modelling

``` r
birth_data = read.csv("./data/birthweight.csv") %>%
  as_tibble()
```

Clean the data. First check if there are missing values.

``` r
birth_data %>% 
  summarise_all(~ sum(is.na(.)))
```

    ## # A tibble: 1 × 20
    ##   babysex bhead blength   bwt delwt fincome frace gaweeks malform menarche
    ##     <int> <int>   <int> <int> <int>   <int> <int>   <int>   <int>    <int>
    ## 1       0     0       0     0     0       0     0       0       0        0
    ## # … with 10 more variables: mheight <int>, momage <int>, mrace <int>,
    ## #   parity <int>, pnumlbw <int>, pnumsga <int>, ppbmi <int>, ppwt <int>,
    ## #   smoken <int>, wtgain <int>

``` r
#no missing values


birth_data %>% 
  select(babysex, frace, mrace, malform) %>% 
  summarise_all(list(~n_distinct(.)))
```

    ## # A tibble: 1 × 4
    ##   babysex frace mrace malform
    ##     <int> <int> <int>   <int>
    ## 1       2     5     4       2

``` r
#clean the data

clean_birth = birth_data %>% 
  mutate_at(c("babysex", "frace", "malform", "mrace", "fincome"), as.factor) %>% 
  mutate_if(is.integer, as.double) 
#  rename(baby_sex = babysex, baby_head = bhead, baby_length = blength, baby_weight = bweight, m_del)
```

To select independent variables for the model, I used scatter plots to
observe the potential association between birth weight and other
variables.

Plots for birth weight against numerical variables:

``` r
clean_birth %>%
  select_if(is.numeric) %>% 
  gather(-bwt, key = "var", value = "value") %>% 
  ggplot(aes(x = value, y = bwt)) +
    geom_point() +
    geom_smooth(method = lm, se = FALSE) +
    facet_wrap(~ var, scales = "free") +
    theme_bw() +
    labs(
    title = "Scatter Plots of Birth Weight Against Other Numeric Variables",
    x = "Numeric Variables",
    y = "Birth Weight"
    )
```

    ## `geom_smooth()` using formula 'y ~ x'

![](p8105_hw6_pz2281_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

From the plots, it can be observed that positive associations
potentially exist between birth weight and baby’s head circumference at
birth, baby’s length at birth, gestational age in weeks, mother’s height
gain during pregnancy. These variables can be selected as predictors of
the model.

Plots for birth weight against categorical variables.

``` r
clean_birth %>%
  select_at(c("bwt", "babysex", "frace", "malform", "mrace")) %>% 
  gather(-bwt, key = "var", value = "value") %>% 
  ggplot(aes(x = value, y = bwt)) +
    geom_point() +
    geom_smooth(method = lm, se = FALSE) +
    facet_wrap(~ var, scales = "free") +
    theme_bw() +
  labs(
    title = "Scatter Plots of Birth Weight Against Other Categorical Variables",
    x = "Categorical Variables",
    y = "Birth Weight"
  )
```

    ## Warning: attributes are not identical across measure variables;
    ## they will be dropped

    ## `geom_smooth()` using formula 'y ~ x'

![](p8105_hw6_pz2281_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->

From the scatter plots, there is no clear relationship between birth
weight and other categorical variables, but a visually noticeable
difference in birth weight does exists based on father/mother’s race, or
the presence of malformations.

Based on the above observations, my hypothesized model contains 5
numeric variables and 2 categorical variables which have shown potential
relationship with birth weight.

Hypothesized Model:

bwt = bhead + blength + delwt + gaweeks + wtgain + frace + mrace

``` r
my_fit = lm(bwt ~ bhead + blength + gaweeks + wtgain + frace + mrace, data = clean_birth)
broom::glance(my_fit) %>% knitr::kable()
```

| r.squared | adj.r.squared |    sigma | statistic | p.value |  df |    logLik |      AIC |      BIC |  deviance | df.residual | nobs |
|----------:|--------------:|---------:|----------:|--------:|----:|----------:|---------:|---------:|----------:|------------:|-----:|
| 0.7070168 |     0.7062725 | 277.5703 |  949.9093 |       0 |  11 | -30583.44 | 61192.87 | 61275.76 | 333606017 |        4330 | 4342 |

``` r
broom::tidy(my_fit) %>% knitr::kable()
```

| term        |     estimate |  std.error |   statistic |   p.value |
|:------------|-------------:|-----------:|------------:|----------:|
| (Intercept) | -5715.406645 | 98.2067089 | -58.1977210 | 0.0000000 |
| bhead       |   133.139984 |  3.4526125 |  38.5620991 | 0.0000000 |
| blength     |    78.052461 |  2.0353113 |  38.3491505 | 0.0000000 |
| gaweeks     |    11.363394 |  1.4767478 |   7.6948780 | 0.0000000 |
| wtgain      |     3.642644 |  0.3951349 |   9.2187351 | 0.0000000 |
| frace2      |    32.269060 | 46.8486191 |   0.6887943 | 0.4909896 |
| frace3      |    34.073029 | 70.5180429 |   0.4831817 | 0.6289911 |
| frace4      |   -28.960171 | 45.3949023 |  -0.6379609 | 0.5235329 |
| frace8      |   -14.162578 | 75.3159130 |  -0.1880423 | 0.8508523 |
| mrace2      |  -156.115473 | 46.7501785 |  -3.3393557 | 0.0008468 |
| mrace3      |  -122.803277 | 72.9210343 |  -1.6840584 | 0.0922425 |
| mrace4      |   -90.755547 | 45.7139879 |  -1.9852905 | 0.0471751 |
